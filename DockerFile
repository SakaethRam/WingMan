# Dockerfile â€“ WingMan X (Voice AI Assistant)
# ----------------------------------------------------
# Base image: Python 3.11 slim (lightweight, secure)
FROM python:3.11-slim

# Set working directory
WORKDIR /app

# Install system dependencies
# - alsa-utils: for audio playback (pygame uses ALSA)
# - portaudio19-dev, libffi-dev: for PyAudio (speech_recognition)
# - gcc, build-essential: for compiling wheels if needed
RUN apt-get update && apt-get install -y --no-install-recommends \
    alsa-utils \
    portaudio19-dev \
    libffi-dev \
    gcc \
    build-essential \
    pulseaudio \
    && rm -rf /var/lib/apt/lists/*

# Copy requirements first (leverages Docker layer caching)
COPY requirements.txt .

# Install Python dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY wingmanx.py .
COPY "WingMan X StudioCode.py" .

# Create non-root user for security
RUN useradd -m appuser
USER appuser

# Expose no ports (voice-only CLI app)

# Default command: run the test script
# Override with: docker run ... python "WingMan X StudioCode.py"
CMD ["python", "WingMan X StudioCode.py"]
